/*
    ListOf.js - A JavaScript implementation of the C# List<T> object
    Copyright (C) 2014  Joel A. Villarreal Bertoldi

    This program is free software: you can redistribute it and/or modify
    it under the terms of the GNU General Public License as published by
    the Free Software Foundation, either version 3 of the License, or
    (at your option) any later version.

    This program is distributed in the hope that it will be useful,
    but WITHOUT ANY WARRANTY; without even the implied warranty of
    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
    GNU General Public License for more details.

    You should have received a copy of the GNU General Public License
    along with this program.  If not, see <http://www.gnu.org/licenses/>.
*/
function ListOf(r){var n=[],t=r,e=function(r){var n=new ListOf(t);return n.add(r),n},i=function(r){var e=function(r){if(typeof r!=t)throw new Error("Item type must be '"+t+"'");n.push(r)};if(Array.isArray(r)){for(var i=0;i<r.length;i++)e(r[i]);return this}return e(r),this},f=function(r){return"object"!=typeof r||Array.isArray(r)?"function"==typeof r?n.filter(r).length==n.length:void 0:I(r).length==n.length},u=function(r){return"object"!=typeof r||Array.isArray(r)?"function"==typeof r?n.filter(r).length>=1:typeof r==t?n.indexOf(r)>-1:!r&&n.length>=1?!0:void 0:I(r).length>=1},o=function(r){return a(r)/n.length},a=function(r){var e=0;if("object"==t&&"string"==typeof r){for(var i=0;i<n.length;i++)e+=n[i][r];return e}if("number"==t){for(var i=0;i<n.length;i++)e+=n[i];return e}},l=function(){return n=[],this},c=function(r){return u(r)},s=function(r){return r?I(r).count():n.length},y=function(r){return n[r]},h=function(r){return e("object"!=typeof r||Array.isArray(r)?"function"==typeof r?n.filter(r):n.filter(function(n){return n!=r}):n.filter(function(n){var t=!0,e=!1;for(var i in r)if(n.hasOwnProperty(i))if(Array.isArray(r[i])){for(var f=0;f<r[i].length;f++)if(n[i]!=r[i][f]){e=!0;break}t=t&&e}else t=t&&n[i]==r[i];return t}))},p=function(r){return u(r)},v=function(){return e(B())},g=function(r){var n=I(r);return n.length>0?n[0]:null},A=function(r){var n=I(r);return n.length>0?n[n.length-1]:null},d=function(r){return r?g(r):n[0]},m=function(r){return r?A(r):n[s()-1]},b=function(r){n.map(r)},x=function(r){if("object"!=typeof r||Array.isArray(r))return n.indexOf(r);for(var t=0;t<n.length;t++){var e=n[t],i=!0,f=!1;if(null!=e){for(var u in r)if(e.hasOwnProperty(u))if(Array.isArray(r[u])){for(var o=0;o<r[u].length;o++)if(e[u]==r[u][o]){f=!0;break}i=i&&f}else i=i&&e[u]==r[u];if(i)return t}else if(null==r)return t}},O=function(r){var t=[];if("object"!=typeof r||Array.isArray(r))for(var e=0;e<n.length;e++)n[e]===r&&t.push(e);else for(var e=0;e<n.length;e++){var i=n[e],f=!0,u=!1;if(null!=i){for(var o in r)if(i.hasOwnProperty(o))if(Array.isArray(r[o])){for(var a=0;a<r[o].length;a++)if(i[o]==r[o][a]){u=!0;break}f=f&&u}else f=f&&i[o]==r[o];f&&t.push(e)}else if(null==r){t.push(e);continue}}return t},j=function(r){return Math.max.apply(null,O(r))},w=function(r,e){if(r>n.length)throw new Error("Index out of range: x must be <= "+n.length);if(typeof e==t)return n.splice(0,r).concat([e]).concat(n.splice(r-1)),this;if(!Array.isArray(e))throw new Error("Item type must be '"+t+"'");return n.splice(0,r).concat(e).concat(n.splice(r-1)),this},k=function(r){return n="object"!=t?n.filter(function(n){return n!=r}):h(what),this},M=function(r){return n=h(y(r)),this},E=function(r,t){for(var e=[],i=r;i<n.length&&r+t>i;i++)e.push(n[i]);return n=e,this},I=function(r){return e("object"!=typeof r||Array.isArray(r)?"function"==typeof r?n.filter(r):n.filter(function(n){return n==r}):n.filter(function(n){var t=!0,e=!1;if(null==n)return!1;for(var i in r)if(n.hasOwnProperty(i))if(Array.isArray(r[i])){for(var f=0;f<r[i].length;f++)if(n[i]==r[i][f]){e=!0;break}t=t&&e}else t=t&&n[i]==r[i];return t}))},L=function(){return"ListOf<"+t+">["+s()+"]"},P=function(){return s()},B=function(){return n},D=function(r){return e(n.slice(0,r))},F=function(r){return e(n.slice(r))},R=function(r){var i=[],f=[];if("object"==t&&"string"==typeof r)for(var u=0;u<n.length;u++)null!=n[u]&&(f.indexOf(n[u][r])>-1||(f.push(n[u][r]),i.push(n[u])));else for(var u=0;u<n.length;u++)i.indexOf(n[u])>-1||i.push(n[u]);return e(i)},S=function(r){return"object"==t&&"string"==typeof r?Math.max.apply(null,n.map(function(n){return n[r]})):Math.max.apply(null,n)},q=function(r){return"object"==t&&"string"==typeof r?Math.min.apply(null,n.map(function(n){return n[r]})):Math.min.apply(null,n)},z=function(r){return"object"==t&&"string"==typeof r?e(n.sort(function(n,t){return null!=n&&null!=t?n[r]>t[r]:!1})):void 0},C=function(r){return e(z(r).toArray().reverse())},G=function(){return e(n.reverse())};return{add:i,all:f,any:u,average:o,clear:l,contains:c,count:s,distinct:R,elementAt:y,except:h,exists:p,find:I,findAll:v,findFirst:g,findLast:A,first:d,forEach:b,indexOf:x,indexesOf:O,insert:w,last:m,lastIndexOf:j,max:S,min:q,orderBy:z,orderByDescendent:C,remove:k,removeAt:M,removeRange:E,reverse:G,take:D,toString:L,toArray:B,skip:F,sum:a,valueOf:P}}
